from django.contrib.staticfiles.testing import StaticLiveServerTestCase
from selenium.webdriver.chrome.webdriver import WebDriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select
from .models import Game, ReviewPost
from accounts.models import CustomUser
from selenium.webdriver import Remote, ChromeOptions
import socket
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from django.test import override_settings

@override_settings(ALLOWED_HOSTS=['*'])  # Disable ALLOW_HOSTS
class LoginTest(StaticLiveServerTestCase):
    host = '0.0.0.0'  # Bind to 0.0.0.0 to allow external access

    @classmethod
    def setUpClass(cls):
        super().setUpClass()
        cls.host = socket.gethostbyname(socket.gethostname())
        cls.selenium = Remote(
                command_executor="http://selenium:4444/wd/hub",
                options=ChromeOptions(),
                desired_capabilities=DesiredCapabilities.CHROME,
                )
        cls.selenium.implicitly_wait(5)

    @classmethod
    def tearDownClass(cls):
        cls.selenium.quit()
        super().tearDownClass()

    def test_signup_success(self):
        # TOPページを開く
        print('%s%s' % (self.live_server_url, '/'))
        self.selenium.get('%s%s' % (self.live_server_url, '/'))
        # ページタイトルの検証
        self.assertEquals('Game Gallery', self.selenium.title)
        print("正常テスト：test処理　完了")
        
